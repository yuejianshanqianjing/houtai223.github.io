import{d as E,J as j,w as q,r as h,I as J,o as K,k as i,a as y,c as k,j as e,e as l,z as L,A as I,l as a,K as G,h as p,F as H,g as O,m as $,t as A,L as Q,E as _,M as R}from"./index-059ef627.js";const W=["onClick"],X=E({name:"shuxing"}),ee=E({...X,setup(Y){let o=j(),f=async()=>{const n=await G(o.c1id,o.c2id,o.c3id);n.code==200&&(b.value=n.data)};q(()=>o.c3id,()=>{b.value=[],o.c3id&&f()});let b=h([]),u=h(0),t=J({id:"",attrName:"",attrValueList:[{attrId:0,id:0,valueName:""}],categoryId:"",categoryLevel:3}),P=()=>{t.attrValueList.push({valueName:"",flag:!0})},w=async()=>{(await Q(t)).code==200?(_({type:"success",message:t.id?"修改成功":"添加成功"}),u.value=0,f()):_({type:"error",message:t.id?"修改失败":"添加失败"})},B=()=>{t.attrValueList=[],t.attrName="",u.value=1,t.categoryId=o.c3id,t.id=""},S=n=>{if(n.valueName.trim()==""){_({type:"warning",message:"属性值不能为空"});return}let d=t.attrValueList.find(g=>{if(g!=n)return g.valueName==n.valueName});if(console.log(d,333),d){_({type:"warning",message:"属性值重复"});return}n.flag=!1},z=n=>{t.attrName=n.attrName,t.categoryId=n.categoryId,t.attrValueList=n.attrValueList,t.id=1,u.value=1},D=async n=>{(await R(n.attrValueList[0].attrId)).code==200?(_({type:"success",message:"删除成功"}),f()):_({type:"success",message:"系统数据，请勿删除"})},F=()=>{f(),setTimeout(()=>{u.value=0},300)};return K(()=>{o.c3id&&f()}),(n,d)=>{const g=i("category"),c=i("el-button"),m=i("el-table-column"),M=i("el-tag"),T=i("el-popconfirm"),C=i("el-table"),N=i("el-card"),V=i("el-input"),v=i("el-form-item"),U=i("el-form");return y(),k("div",null,[e(g,{scene:l(u)},null,8,["scene"]),L(e(N,{style:{margin:"10px 0px"}},{default:a(()=>[e(c,{icon:"Plus",type:"primary",disabled:!l(o).c3id,onClick:l(B)},{default:a(()=>[p(" 添加属性 ")]),_:1},8,["disabled","onClick"]),e(C,{style:{margin:"10px 0"},border:"",data:l(b)},{default:a(()=>[e(m,{type:"index",width:"80",label:"序号",align:"center"}),e(m,{label:"属性名称",width:"120",prop:"attrName"}),e(m,{label:"属性值名称"},{default:a(({row:s,$index:x})=>[(y(!0),k(H,null,O(s.attrValueList,r=>(y(),$(M,{key:r.id,style:{margin:"5px"}},{default:a(()=>[p(A(r.valueName),1)]),_:2},1024))),128))]),_:1}),e(m,{label:"操作",width:"120"},{default:a(({row:s,$index:x})=>[e(c,{type:"primary",icon:"Edit",size:"small",onClick:r=>l(z)(s)},null,8,["onClick"]),e(T,{title:"是否确认删除",onConfirm:r=>l(D)(s)},{reference:a(()=>[e(c,{type:"primary",icon:"Delete",size:"small"})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1},512),[[I,l(u)==0]]),L(e(N,{style:{margin:"10px 0px"}},{default:a(()=>[e(U,null,{default:a(()=>[e(v,{label:"属性名称"},{default:a(()=>[e(V,{style:{width:"200px"},placeholder:"请您输入属性名称",modelValue:l(t).attrName,"onUpdate:modelValue":d[0]||(d[0]=s=>l(t).attrName=s)},null,8,["modelValue"])]),_:1}),e(v,null,{default:a(()=>[e(c,{type:"primary",icon:"Plus",disabled:!l(t).attrName,onClick:l(P)},{default:a(()=>[p("添加属性值")]),_:1},8,["disabled","onClick"]),e(c,{onClick:d[1]||(d[1]=s=>l(t).attrName="")},{default:a(()=>[p("取消")]),_:1})]),_:1}),e(v,null,{default:a(()=>[e(C,{border:"",data:l(t).attrValueList},{default:a(()=>[e(m,{label:"序号",type:"index",align:"center",width:"80"}),e(m,{label:"属性值名称"},{default:a(({row:s,$index:x})=>[s.flag?(y(),$(V,{key:0,placeholder:"请输入属性值",modelValue:s.valueName,"onUpdate:modelValue":r=>s.valueName=r,onBlur:r=>l(S)(s)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(y(),k("div",{key:1,onClick:r=>s.flag=!0},A(s.valueName),9,W))]),_:1}),e(m,{label:"操作"})]),_:1},8,["data"])]),_:1})]),_:1}),e(v,null,{default:a(()=>[e(c,{type:"primary",onClick:l(w),disabled:!(l(t).attrValueList.length>0)},{default:a(()=>[p("保存")]),_:1},8,["onClick","disabled"]),e(c,{onClick:l(F)},{default:a(()=>[p("取消")]),_:1},8,["onClick"])]),_:1})]),_:1},512),[[I,l(u)==1]])])}}});export{ee as default};
